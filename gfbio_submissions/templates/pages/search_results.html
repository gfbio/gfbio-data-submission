{% extends "base_content.html" %}
{% load crispy_forms_tags %}

{% block section %}

    <section class="search-page-title" xmlns="http://www.w3.org/1999/html">
        <div class="container search-title-container">

            <div class="row">
                <div class="col-sm-12 text-center">
                    <h4 class="uppercase mb-2">Search & find research data</h4>
                    <p class="lead mb-4">
                        Enter author name, measurement, taxon, project or any
                        domain specific term to search.
                    </p>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-10 mx-auto">
                    {# Search Form #}
                    <form action="" method="get">
                        <div class="form-row">
{#                            {% crispy form %}#}
                            <div class="form-group col-md-4">
                                <button type="submit"
                                        class="btn btn-block btn-secondary btn-search"
                                        id="submit-search"><i
                                        class="ti-search icon pr-2"></i>Search
                                </button>
                            </div>
{#                            {% if form.errors.query %}#}
{#                                <div class="row">#}
{#                                    <div class="col-md-12 text-left">#}
{#                                        {{ form.errors.query }}#}
{#                                    </div>#}
{#                                </div>#}
{#                            {% endif %}#}

                        </div>
                    </form>
                    {# End Search Form #}
                </div>
            </div>

            <div class="row">
                <div class="col-sm-12 text-center">
                    <p>
                        For example try one of these:
                        <a href="/search/?query=Drosophila">Drosophila</a>,
                        <a href="/search/?query=Hydrothermal Vents">Hydrothermal
                            Vents</a> or
                        <a href="/search/?query=Arctic Coring Expedition">Arctic
                            Coring Expedition</a>

                    </p>
                </div>
            </div>

        </div>
    </section>

    <section class="search-results">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    {% if desc %}
                        <div class="row">
                            <div class="col-sm-10 mx-auto">
                                <h4 class="text-center">How to proceed here
                                    ?</h4>
                                <p class="text-center">
                                    Enter a search term into the input field
                                    above, then hit
                                    return on your keyboard or click the blue
                                    button left to
                                    the input. Try one of the links below of the
                                    input field
                                    to trigger an example search to get an idea
                                    how this here works.
                                </p>
                            </div>
                        </div>
                    {% else %}
                        {% if results %}
                            <div class="row">
                                <div class="col-sm-12">
                                    <h6>{{ totalCount }} results
                                        for {{ form_data.query }}
                                    </h6>
                                    <hr class="">
                                </div>
                            </div>

                            {% for r in results %}
                                <div class="row">
                                    <div class="col-sm-12 result-col">
                                        {{ r.html | safe }}
                                    </div>
                                </div>
                            {% endfor %}

                            <div class="row">
                                <div class="col-sm-12">
                                    <hr class="search-bottom">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6 text-left">
                                    <h6>Results {{ from }} - {{ to }}</h6>
                                </div>
                                <div class="col-sm-6">

                                    <nav aria-label="Search results pages">
                                        <ul class="pagination pagination-sm justify-content-end">

                                            {% if paginator_results.has_previous %}
                                                <li class="page-item">
                                                    <a class="page-link"
                                                       href="/search/?query={{ form_data.query }}&page={{ paginator_results.previous_page_number }}">Previous</a>
                                                </li>
                                            {% endif %}

                                            {% for r in range %}
                                                {% if form_data.page == r %}
                                                    <li class="page-item active">
                                                        {% else %}
                                                    <li class="page-item">
                                                {% endif %}
                                            <a class="page-link"
                                               href="/search/?query={{ form_data.query }}&page={{ r }}">{{ r }}</a>
                                            </li>
                                            {% endfor %}

                                            {% if paginator_results.has_next %}
                                                <li class="page-item">
                                                    <a class="page-link"
                                                       href="/search/?query={{ form_data.query }}&page={{ paginator_results.next_page_number }}">Next</a>
                                                </li>
                                            {% endif %}

                                        </ul>
                                    </nav>

                                </div>
                            </div>
                        {% else %}
                            <div class="row">
                                <div class="col-sm-12 text-center">
                                    <h4> No results found for <br/>
                                        '{{ form_data.query }}'</h4>
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                    {# end if results #}
                </div>
            </div>
        </div>

    </section>

{% endblock section %}
